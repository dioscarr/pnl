#pragma checksum "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "36ad235398360ed9a991e6c5f81fc3997672ef26"
// <auto-generated/>
#pragma warning disable 1591
namespace pnl.Components
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using pnl.Models.Helpers;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using MatBlazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using pnl;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using pnl.Data.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using pnl.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using pnl.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using Microsoft.AspNetCore.Mvc.TagHelpers;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "D:\Users\diosc\Repos\pnl\_Imports.razor"
using BlazorAnimate;

#line default
#line hidden
#nullable disable
    public partial class NewTaxYear : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
#nullable restore
#line 3 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
 if (!FileNew)
{
    

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
     foreach (var item in TaxYearsInProcess)
    {

        

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
         if (FileNewPosition)
        {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(0, "div");
            __builder.AddAttribute(1, "class", "TaxYearsInProcess animate__animated animate__bounceInDown");
            __builder.OpenElement(2, "button");
            __builder.AddAttribute(3, "class", "FileNew");
            __builder.AddAttribute(4, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 11 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                                                  () => { FileNew = true; }

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(5, "Get Started");
            __builder.CloseElement();
            __builder.AddMarkupContent(6, "\r\n                ");
            __builder.AddContent(7, 
#nullable restore
#line 12 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                 setFileNewPosition(false)

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 14 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
        }

#line default
#line hidden
#nullable disable
            __builder.OpenElement(8, "div");
            __builder.AddAttribute(9, "class", "TaxYearsInProcess");
            __builder.OpenElement(10, "button");
            __builder.AddAttribute(11, "class", "Continueapplication animate__animated animate__bounceInDown");
            __builder.AddAttribute(12, "style", "background-color:white;");
            __builder.AddAttribute(13, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 17 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                              async () => { TaxYear = item.TaxYear; FilingStatus = item.FilingStatusID; await CreateNewTaxFormAsync(); }

#line default
#line hidden
#nullable disable
            ));
            __builder.AddMarkupContent(14, "<div>Tax Return</div>\r\n                ");
            __builder.OpenElement(15, "div");
            __builder.AddContent(16, 
#nullable restore
#line 19 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                      item.TaxYear

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(17, "\r\n                ");
            __builder.AddMarkupContent(18, "<div>Continue..</div>");
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 23 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
    }

#line default
#line hidden
#nullable disable
#nullable restore
#line 23 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
     
}

#line default
#line hidden
#nullable disable
#nullable restore
#line 25 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
 if (TaxYearsInProcess.Count() == 0 || FileNew)
{

#line default
#line hidden
#nullable disable
            __builder.OpenElement(19, "div");
            __builder.AddAttribute(20, "class", "new-tax-year");
            __builder.OpenElement(21, "div");
            __builder.AddAttribute(22, "class", "custom-select-taxt-year");
            __builder.OpenElement(23, "select");
            __builder.AddAttribute(24, "onchange", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.ChangeEventArgs>(this, 
#nullable restore
#line 29 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                               async (ChangeEventArgs args) => { await CheckIfTaxExist(args); }

#line default
#line hidden
#nullable disable
            ));
            __builder.OpenElement(25, "option");
            __builder.AddAttribute(26, "value", "-1");
            __builder.AddContent(27, "--Select a year--");
            __builder.CloseElement();
#nullable restore
#line 31 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                 foreach (int aYear in TaxYears.OrderByDescending(c=>c))
                {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(28, "option");
            __builder.AddAttribute(29, "value", 
#nullable restore
#line 33 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                                    aYear

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(30, 
#nullable restore
#line 33 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                                            aYear

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 34 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(31, "\r\n        ");
            __builder.OpenElement(32, "div");
            __builder.AddAttribute(33, "class", "filing-status");
            __builder.OpenElement(34, "select");
            __builder.AddAttribute(35, "onchange", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.ChangeEventArgs>(this, 
#nullable restore
#line 38 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                               (ChangeEventArgs args) => { HandleFilingStatusChange(args); StateHasChanged(); }

#line default
#line hidden
#nullable disable
            ));
            __builder.OpenElement(36, "option");
            __builder.AddAttribute(37, "value", "-1");
            __builder.AddContent(38, "Select Filing Status");
            __builder.CloseElement();
#nullable restore
#line 40 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                 foreach (FilingStatus fs in filingStatuses)
                {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(39, "option");
            __builder.AddAttribute(40, "value", 
#nullable restore
#line 42 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                                    fs.Id

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(41, 
#nullable restore
#line 42 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                                            fs.Name

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 43 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(42, "\r\n\r\n        ");
            __builder.OpenElement(43, "div");
            __builder.AddAttribute(44, "class", "selectablemap");
            __builder.OpenComponent<pnl.Components.USAMap>(45);
            __builder.AddAttribute(46, "OnMapStateSeletion", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<System.String>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<System.String>(this, 
#nullable restore
#line 48 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                                       handleStatesClick

#line default
#line hidden
#nullable disable
            )));
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.AddMarkupContent(47, "\r\n\r\n        ");
            __builder.OpenElement(48, "div");
            __builder.AddAttribute(49, "class", "states-dd");
            __builder.OpenElement(50, "select");
#nullable restore
#line 53 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                 foreach (state item in states)
                {
                    if (selectedState == item.abbreviation)
                    {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(51, "option");
            __builder.AddAttribute(52, "selected", "selected");
            __builder.AddAttribute(53, "value", 
#nullable restore
#line 57 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                                                          item.abbreviation

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(54, 
#nullable restore
#line 57 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                                                                              item.name

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 58 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                    }
                    else
                    {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(55, "option");
            __builder.AddAttribute(56, "value", 
#nullable restore
#line 61 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                                        item.abbreviation

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(57, 
#nullable restore
#line 61 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                                                            item.name

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 62 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                    }
                }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(58, "\r\n        ");
            __builder.OpenElement(59, "div");
            __builder.AddAttribute(60, "class", "FilingStatus");
#nullable restore
#line 67 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
             if (isSubmitVisiable || FilingStatus > 0)
            {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(61, "button");
            __builder.AddAttribute(62, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 69 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
                                   CreateNewTaxFormAsync

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(63, "Start");
            __builder.CloseElement();
#nullable restore
#line 70 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
            }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 73 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
}

#line default
#line hidden
#nullable disable
        }
        #pragma warning restore 1998
#nullable restore
#line 74 "D:\Users\diosc\Repos\pnl\Components\NewTaxYear.razor"
       
    [Parameter]
    public EventCallback<int> OnNewTaxYearEvent { get; set; }
 
    private int TaxYear { get; set; } = 0;
    private List<int> TaxYears { get; set; }
    private List<TaxForm> TaxYearsInProcess { get; set; }
    public List<state> states { get; set; }
    private int FilingStatus { get; set; } = -1;
    private int TaxFormId { set; get; } = 0;
    private bool isFilingStatusVisiable { get; set; } = false;
    private bool isSubmitVisiable { get; set; } = false;
    public List<FilingStatus> filingStatuses { get; set; }
    public string selectedState { get; set; }
    private bool FileNewPosition { get; set; } = true;
    private bool FileNew { get; set; } = false;


    private string setFileNewPosition(bool value)
    {
        FileNewPosition = value;
        return "";
    }

    protected override void OnInitialized()
    {
        TaxYears = new List<int>();
        (TaxYears, TaxYearsInProcess) = service.GetTaxYears();
        states = service.GetStates();
        filingStatuses = new List<FilingStatus>();
        filingStatuses = service.GetfilingStatuses();
        base.OnInitialized();
    }

    private void HandleTaxYearChange(ChangeEventArgs args)
    {
        if (int.TryParse(args.Value?.ToString(), out int taxYear))
        {
            TaxYear = taxYear;
        }
    }
    private void HandleFilingStatusChange(ChangeEventArgs args)
    {

        if (int.TryParse(args.Value?.ToString(), out int filingstatus))
        {
            FilingStatus = filingstatus;
        }
        if (FilingStatus > 0)
        {
            isSubmitVisiable = true;
        }
        else
        {
            isSubmitVisiable = false;
        }
    }
    private async Task CheckIfTaxExist(ChangeEventArgs args)
    {
        if (int.TryParse(args.Value?.ToString(), out int taxYear))
        {
            TaxYear = taxYear;
            isFilingStatusVisiable = true;
            TaxForm t = await service.CheckIfTaxExist(TaxYear);
            if (t != null)
            {
                TaxFormId = t.ID;
            }
            StateHasChanged();
        }
    }

    private void handleStatesClick(string abbr)
    {
        selectedState = abbr;
    }

  
    private async Task CreateNewTaxFormAsync()
    {
        if (TaxYear.ToString().Count() == 4)
        {
            TaxForm t = await service.CreateNewTaxFormAsync(TaxYear, FilingStatus);
            TaxFormId = t.ID;
            TaxYears = new List<int>();
            TaxYears.Add(TaxYear);
            await OnNewTaxYearEvent.InvokeAsync(t.ID);
            StateHasChanged();
        }
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private TaxFormService service { get; set; }
    }
}
#pragma warning restore 1591
